export default function(e){var t=(e=e||{}).lazyClass||"lazy",r=e.lazyBackgroundClass||"lazy-bg",a="idleLoadTimeout"in e?e.idleLoadTimeout:200,o=e.observeChanges||!1,i=e.events||{},n=window,s="requestIdleCallback",d="IntersectionObserver",l=["srcset","src","poster"],c=[],u=(e,a)=>c.slice.call((a||document).querySelectorAll(e||"img."+t+",video."+t+",iframe."+t+",."+r)),v=t=>{var a,o=t.parentNode;"PICTURE"==o.nodeName&&(a=o),"VIDEO"==t.nodeName&&(a=t),m(u("source",a),g),g(t),t.autoplay&&t.load();var i=t.classList;i.contains(r)&&(t.setAttribute("style",'background-image: url("'+t.dataset.src+'");'),i.remove(r),i.add(e.lazyBackgroundLoaded||"lazy-bg-loaded"))},b=e=>{for(var t in i)e.addEventListener(t,i[t].listener||i[t],i[t].options||void 0)},g=e=>{var t=function(t){l[t]in e.dataset&&n.requestAnimationFrame(()=>{e.setAttribute(l[t],e.dataset[l[t]])})};for(var r in l)t(r)},m=(e,t)=>{for(var r in e)t instanceof n[d]?t.observe(e[r]):t(e[r])},f=e=>{if(e.isIntersecting||e.intersectionRatio){var r=e.target;s in n&&a?n[s](()=>{v(r)},{timeout:a}):v(r),r.classList.remove(t),p.unobserve(r),(h=h.filter(e=>e!=r)).length||o||p.disconnect()}},y=e=>{h.indexOf(e)<0&&(h.push(e),b(e),p.observe(e))},h=u();if(/baidu|(?:google|bing|yandex|duckduck)bot/i.test(navigator.userAgent))m(h,v);else if(d in n&&d+"Entry"in n){var p=new n[d](e=>{m(e,f)},{rootMargin:("threshold"in e?e.threshold:200)+"px 0%"});m(h,b),m(h,p),o&&m(u(e.observeRootSelector||"body"),t=>{new MutationObserver(()=>{m(u(),y)}).observe(t,e.mutationObserverOptions||{childList:!0,subtree:!0})})}}
